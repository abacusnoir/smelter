#!/usr/bin/env smt run

(coalton-toplevel
  ;; Simple JSON parsing test that works with current Smelter
  (declare test-json-parse (Unit -> Unit))
  (define (test-json-parse _)
    ;; Test basic JSON number parsing
    (match (smelter.stdlib.json:parse-json "42")
      ((Ok json-val)
       Unit)
      ((Err error)
       Unit))

    ;; Test basic JSON string parsing
    (match (smelter.stdlib.json:parse-json "\"hello\"")
      ((Ok json-val)
       Unit)
      ((Err error)
       Unit))

    ;; Test basic JSON boolean parsing
    (match (smelter.stdlib.json:parse-json "true")
      ((Ok json-val)
       Unit)
      ((Err error)
       Unit))))

;; Print test status and run the test
(cl:format cl:*standard-output* "Testing JSON functionality...~%")
(test-json-parse Unit)
(cl:format cl:*standard-output* "JSON tests completed~%")